!!!### langage independant
!!
# update_field is number of field to update
# update_content is the new content.



scnt=!recordcnt wimshome/log/classes/$wims_class/sheets/.sheets
!for s=1 to $scnt
  sheet_$s=!record $s of wimshome/log/classes/$wims_class/sheets/.sheets
  !! CAREFUL : need to take two line more than number of line you wish (bug cmd !line ?)
  sheet_$s=!line 1 to 12 of $(sheet_$s)\
\
\
\
\
\
\
\
\
\
\

!next s

!if $update_field!=0
  sheet_$sheet=!replace line number $update_field by $update_content in $(sheet_$sheet)
!else
  !mexec sheetshift.sh
!endif

!writefile wimshome/log/classes/$wims_class/sheets/.sheets
!for s=1 to $scnt
  !if $s!=$sheet or $update_field!=0
    sf=!line 1 to 10 of $(sheet_$s)
    !appendfile wimshome/log/classes/$wims_class/sheets/.sheets :$sf
  !endif
!next s
