!if $un=$empty
  un=$getuser
!endif
u=!positionof item $un in $ulist
f_=!item $u of $flist
l_=!item $u of $llist
username=$f_ $l_
uu_cnt=!recordcnt wimshome/log/classes/$wims_class/.grades
!if $reg!=$empty
  glist=$un,$username
  !for g=1 to $gcnt
   !bound c$g between 0 and $maxscore default $joker
   glist=!append item $(c$g) to $glist
  !next g
  glist=!replace internal $joker by $empty in $glist
  !if $un isitemof $uulist
    update_field=!positionof item $un in $uulist
    update_field=$[$update_field+1]
    update_content=$glist
    update_nbline=$empty
    !read adm/uprecord wimshome/log/classes/$wims_class/.grades
  !else
    !appendfile wimshome/log/classes/$wims_class/.grades :$glist
  !endif
  !read var.init
!endif

u_=!positionof item $un in $uulist
!if $u_ !=
 grades=!record $u_+1 of wimshome/log/classes/$wims_class/.grades
 grades=!item 3 to -1 of $grades
!else
 glist=!makelist $joker for x=1 to $gcnt
 grades=!replace internal $joker by $empty in $glist
!endif

