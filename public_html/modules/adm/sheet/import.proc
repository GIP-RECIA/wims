!if $n<=0
  !exit
!endif

max_sheets=!defof MAX_SHEETS in wimshome/public_html/bases/sys/define.conf
snum=!recordcnt wimshome/log/classes/$wims_class/sheets/.sheets
!if $snum>=$max_sheets
  error=bad_maxsheet
  !exit
!endif

!readdef wimshome/log/classes/$wims_class/.def
!if $wims_superclass!=$empty
  class_expiration=!defof class_expiration in wimshome/log/classes/$wims_superclass/.def
!endif

!appendfile wimshome/log/classes/$wims_class/sheets/.sheets \
:0\
$class_expiration\
$sheet_title\
$sheet_desc

!increase snum
Data=!replace internal ../wimshome/ by $wims_home/ in ../$data
!sh cp $Data $wims_home/log/classes/$wims_class/sheets/.sheet$snum

!restart module=adm/class/sheet&sheet=$snum
