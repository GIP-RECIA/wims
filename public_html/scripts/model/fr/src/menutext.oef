type=gapfill
textarea="data pre post"
iEdit="pre post"

:Réponses à choisir (menu déroulant ou étiquette) dans un texte proposé aléatoirement.

Cet exercice présente des textes où des champs à choix multiples sont insérés.
<p>
Pour construire un exercice avec ce modèle, il suffit d'entrer les textes.
Une syntaxe facile permet d'incorporer les champs de choix dans les textes.
</p><p class="wims_credits">
Auteur du modèle : <a href="mailto:qualite@wimsedu.info">Gang Xiao</a> modifié par Bernadette Perrin-Riou
    (ajout de l'option clickfill)</p>

:%%%%%%%%%%%%%%%%%      ATTENTION      %%%%%%%%%%%%%%%%%%%%

Enlevez l'en-tête ci-dessus si vous détruisez les balises pour le modèle !
(Ce sont les lignes qui commencent par un ':'.)
Sinon l'exercice risque de ne pas pouvoir repasser sous Createxo.

:%%%%%%%% Paramètres d'exemples à redéfinir %%%%%%%%%%%%%%%%%

:\title{Menus déroulants ou étiquettes dans plusieurs textes}
:\author{XIAO, Gang}
:\email{qualite@wimsedu.info}
:\credits{}

:Format des réponses
Possibilités : menu, clickfill, dragfill
<ul><li><dl class="tt">clickfill</dl> étiquette à déplacer (une étiquette peut servir plusieurs fois).
</li>
<li><dl class="tt">dragfill</dl> étiquette à déplacer (chaque étiquette ne peut être
utilisée qu'une seule fois).
</li>
<li><dl class="tt">menu</dl> menu déroulant.
</li></ul>
\text{format=item(1,menu,
	clickfill,
	dragfill)}

:Taille des cases (clickfill, dragfill)
\text{len=150 x 35}

:Texte affiché avant la question
Balises html admises. Peut être vide.
$embraced_randitem
\text{pre=<p>Complétez le texte :</p>}

:Données principales
<p>Écrire des textes séparés par des points virgules.
  Les textes eux-mêmes ne peuvent donc pas contenir
  des point-virgules.</p><p>
La question à poser doit être mise entre une paire de
double-point d'interrogation "??", la bonne réponse étant en premier.
  On peut poser jusqu'à 20 questions dans un même texte.</p>
$embraced_randitem
\text{data=
Le dernier empereur ??Pu Yi, Pu Jie, Ci Xi, Yuan Shikai??
de la dernière dynastie chinoise ??Qing,Ming,Song,Tang?? fut destitué par
??une révolte militaire,les envahisseurs japonais,l'armée Rouge soviétique,
les communistes?? en
??1911,1917,1937,1945,1949??. Il
??est décédé par maladie,a été exécuté,s'est suicidé?? en
??1967,1911,1918,1945,1950,1960?? à Beijing.;

Après une bataille ??féroce,facile??, les japonais ont envahi Shanghai en
??1937,1932,1938,1940,1941,1942?? qui comptait une concession
occidentale "commune" à l'époque. Ils ont
??partiellement,totalement,nullement?? respecté la neutralité de la concession
pendant l'occupation jusqu'en ??1941,1939,1942,1945??. L'abolition de la
concession fut prononcée pour la première fois par le gouvernement
??fantoche,nationaliste,communiste??
en ??1943,1945,1949,1960??.;

La première guerre de l'opium a été déclenchée par
??la Grande Bretagne,la France, les Etats-Unis, plusieurs pays occidentaux??
contre ??la Chine, l'Inde?? en ??1839,{1739,1741,1756},1841,1856??, dans le but
??de protéger,d'interdire?? le trafic de drogue (opium). Cette guerre s'est
soldée par la capitulation du gouvernement ??chinois,indien??
??3,2,4,5,8?? ans après, avec la signature du traité de
??Nankin,Pekin,Canton,Maguan,Taiping,Tianjin??.;
}

:Texte affiché après la question
Balises html admises. Peut être vide.
$embraced_randitem
\text{post=}

:Mise en aléatoire par des accolades emboitables
$embraced_randitem
\text{accolade=item(1,1 oui,
2 non)}

:%%%%%%%%%%%%%% Rien à modifier avant l'énoncé %%%%%%%%%%%%%%%%
\text{accolade=wims(word 1 of \accolade)}
\text{format=wims(word 1 of \format)}
\text{len=\format issametext menu ? }
\text{data=wims(singlespace \data)}
\text{data=wims(nonempty rows \data)}
\text{data=randomrow(\data)}
\text{data=\accolade=1 ?wims(embraced randitem \data)}
\text{data=slib(text/cutchoice2 \data)}
\integer{qs=min(20,floor(rows(\data)/2))}

\text{good=}
\text{field=}
\text{latextext= \data[1;]}
\text{latexsol=\data[1;]}
\for{i=1 to \qs}{
 \text{f=\data[2*\i;]}
 \text{g=\f[1]}
 \text{f=wims(sort items \f)}
 \text{g1=positionof(\g,\f)}
 \text{good=\format iswordof clickfill dragfill ?\good\g,:\good\g1,}
 \text{field=\field\f;}
  \integer{nbc = items(\f)-1}
  \for{ii = 1 to \nbc}{
    \text{latextext=\latextext \listchoice{\f[\ii]} / }}
  \text{latextext=\latextext \listchoice{\f[\nbc+1]} \data[2*\i+1;]}
  \text{latexsol=\latexsol \goodchoice{\field[\i;\g1]} \data[2*\i+1;]}
}

\text{pre=\accolade=1 ?wims(embraced randitem \pre)}
\text{post=\accolade=1 ?wims(embraced randitem \post)}
\text{qlist=wims(makelist reply x for x=1 to \qs)}
\steps{\qlist}

:%%%%%%%%%%%%% Maintenant l'énoncé en code html. %%%%%%%%%%%%%%%%%%%%

::Vous n'avez pas besoin de modifier ceci en général.

\statement{
  <div class="instruction">\pre</div>
  \data[1;]
  \for{k=1 to \qs}{
    \embed{r \k,\len} \data[2*\k+1;]
  }
  \post
}

:%%%%%%%%%%%%% Rien à modifier ci-après. %%%%%%%%%%%%%%%%%5

\answer{Champ 1}{\good[1];\field[1;]}{type=\format}
\answer{Champ 2}{\good[2];\field[2;]}{type=\format}
\answer{Champ 3}{\good[3];\field[3;]}{type=\format}
\answer{Champ 4}{\good[4];\field[4;]}{type=\format}
\answer{Champ 5}{\good[5];\field[5;]}{type=\format}
\answer{Champ 6}{\good[6];\field[6;]}{type=\format}
\answer{Champ 7}{\good[7];\field[7;]}{type=\format}
\answer{Champ 8}{\good[8];\field[8;]}{type=\format}
\answer{Champ 9}{\good[9];\field[9;]}{type=\format}
\answer{Champ 10}{\good[10];\field[10;]}{type=\format}
\answer{Champ 11}{\good[11];\field[11;]}{type=\format}
\answer{Champ 12}{\good[12];\field[12;]}{type=\format}
\answer{Champ 13}{\good[13];\field[13;]}{type=\format}
\answer{Champ 14}{\good[14];\field[14;]}{type=\format}
\answer{Champ 15}{\good[15];\field[15;]}{type=\format}
\answer{Champ 16}{\good[16];\field[16;]}{type=\format}
\answer{Champ 17}{\good[17];\field[17;]}{type=\format}
\answer{Champ 18}{\good[18];\field[18;]}{type=\format}
\answer{Champ 19}{\good[19];\field[19;]}{type=\format}
\answer{Champ 20}{\good[20];\field[20;]}{type=\format}

\latex{
\begin{statement}
\pre \ \newline
\latextext \newline
\post
\end{statement}
\begin{solution}
\latexsol
\end{solution}
}
