
!if $sstyle=1
  !if $substep=0
    !if $all_steps=0
      !form reply
      ¿Cual es el <em>primer</em> paso erróneo de esta serie?
      !formselect badstep from 0 to $stepcnt
      (0 significaría que todos los pasos son correctos).
      <div class="wimscenter">
      <input type="submit" value="Enviar la respuesta"></div>
    !else
      Marque a continuación <em>todos</em> los pasos erróneos, y después
      <input type="submit" value="pulse aquí">.
    !endif
    !formend
  !else
    !if $all_steps=0
      !if $badstep=0
        Efectivamente, todos los pasos son correctos.
      !else
        Efectivamente, el primer paso erróneo es el número $badstep.
      !endif
    !endif
    Su puntuación: $module_score/10.
    !if $expstep!=$empty
      <p>Algunas explicaciones.
      </p><ul>
      !for i in $expstep
        <li> Paso $i
        !if $i isitemof $badstep
          es correcto.
          !line $i of $remarks
        !else
          !set j=!positionof item $i in $bad_steps
          !set e=!item $j of $bad_reasons
          no es correcto.
          !read reasons/$e.det
        !endif
        </li>
      !next i
      </ul>
    !endif
  !endif
!else
  !if $substep=0
    !form reply
    ¿Qué piensa del <em>último</em> paso?
    !formselect ans list --,OK,$bad_reasons prompt No sé,\
    	Sí: este paso es correcto,$bad_rnames
    <input type="submit" value="Enviar">
    !formend
  !endif

  !if $substep=2
    Tiene razón:
    !if $step_reason=OK
       el último paso es correcto.
    !else
      El último paso es erróneo.
      El paso correcto sería
      <div class="wimscenter">
      !line $step of $good
      </div>
    !endif
    <p>
    !if $step<$stepcnt
      !href cmd=reply&ans=next Pasar al siguiente paso.
    !else
      Este es el final del ejercicio. Su puntuación: $module_score/10.
    !endif
    </p>
  !endif
!endif
